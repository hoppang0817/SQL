--10장 DML
--DEPT테이블을 카피해서 DETP_TEMP생성
CREATE TABLE  DEPT_TEMP
  AS SELECT * FROM DEPT;

--테이블 삭제
DROP TABLE DEPT_TEMP;
--검색
SELECT *FROM DEPT_TEMP;

--INSERT 테이블에 데이터입력
INSERT INTO DEPT_TEMP(DEPTNO,DNAME,LOC) 
           VALUES(50,'DATABASE','SEOUL');
           
--10-4 열지정 없이 데이터 추가
INSERT INTO DEPT_TEMP
           VALUES(60,'NETWORK','BUSAN');

--10-5 널값 입력하기
INSERT INTO DEPT_TEMP
           VALUES(70,'WEB',NULL);

--10-6 공백문자열로 NULL입력
INSERT INTO DEPT_TEMP
           VALUES(80,'MOBILE','');

--10-7 열데이터를 넣지 않는방식으로 NULL입력
INSERT INTO DEPT_TEMP(DEPTNO,LOC)
           VALUES(90,'INCHEON');




--EMP 테이블 복사 => 1<>1은 거짓 이기때문에 테이블만 생성되고 데이터는 복사하지못함
CREATE TABLE EMP_TEMP
   AS SELECT * FROM EMP WHERE 1<>1;
   
SELECT * FROM EMP_TEMP;

--10-9 날짜데이터입력(YYYY-MM-DD 순으로 입력해야함)
INSERT INTO EMP_TEMP(EMPNO,ENAME,JOB,MGR,HIREDATE,SAL,COMM,DEPTNO)
           VALUES(9999,'홍길동','PRESIDENT',NULL,'2001/01/01',500,1000,10);

INSERT INTO EMP_TEMP(EMPNO,ENAME,JOB,MGR,HIREDATE,SAL,COMM,DEPTNO)
           VALUES(1111,'성춘향','MANAGER',9999,'2001-01-05',400,NULL,20);

--10-12 TO_DATE함수 사용해서 입력
INSERT INTO EMP_TEMP(EMPNO,ENAME,JOB,MGR,HIREDATE,SAL,COMM,DEPTNO)
           VALUES(2111,'이순신','MANAGER',9999,TO_DATE('07/01/2001','DD/MM/YYYY'),4000,NULL,20);

--10-13 SYSDATE 사용 => 현제시점의 날짜와 시간 입력
INSERT INTO EMP_TEMP(EMPNO,ENAME,JOB,MGR,HIREDATE,SAL,COMM,DEPTNO)
           VALUES(3111,'심청이','MANAGER',9999,SYSDATE,4000,NULL,30);
           

-- 수정하기
--10-15 
CREATE TABLE DEPT_TEMP2
      AS SELECT * FROM DEPT;

SELECT * FROM DEPT_TEMP2;

--10-16 업데이트 주의 WHERE절없으면 전체 테이블이 다 업데이트
UPDATE DEPT_TEMP2 SET LOC = 'SEOUL';

ROLLBACK;

--10-18 WHERE절 사용
UPDATE DEPT_TEMP2 SET DNAME = 'DATABASE',LOC = 'SEOUL' WHERE DEPTNO = 40;

--10-21 서브쿼리 사용
UPDATE DEPT_TEMP2 
         SET LOC = 'SEOUL'
WHERE DEPTNO =(SELECT DEPTNO FROM DEPT_TEMP2 WHERE DNAME = 'SALES');



--삭제하기 DELETE
--테이블 생성
CREATE TABLE EMP_TEMP2
  AS SELECT * FROM EMP;
  
SELECT * FROM EMP_TEMP2;

--10-23 직업이 매니저인사람만 삭제
DELETE FROM EMP_TEMP2 WHERE JOB='MANAGER';

DELETE FROM EMP_TEMP2;




--연습문제
CREATE TABLE CHAP10HW_EMP AS SELECT * FROM EMP;
CREATE TABLE CHAP10HW_DEPT AS SELECT * FROM DEPT;
CREATE TABLE CHAP10HW_SALGRADE AS SELECT * FROM SALGRADE;

--1
INSERT INTO CHAP10HW_DEPT (DEPTNO,DNAME,LOC)
                   VALUES(50,'ORACLE','BUSAN');
INSERT INTO CHAP10HW_DEPT (DEPTNO,DNAME,LOC)
                   VALUES(60,'SQL','ILSAN');
INSERT INTO CHAP10HW_DEPT (DEPTNO,DNAME,LOC)
                   VALUES(70,'SELECT','INCHEON');
INSERT INTO CHAP10HW_DEPT(DEPTNO,DNAME,LOC)
                   VALUES(80,'DML','BUNDANG');
 
--2                   
INSERT INTO CHAP10HW_EMP VALUES(7201,'TEST_USER1','MANAGER',7788,'2016/01/02',4500,'',50);
INSERT INTO CHAP10HW_EMP VALUES(7202,'TEST_USER2','MANAGER',7201,'2016/02/21',1800,'',50);
INSERT INTO CHAP10HW_EMP VALUES(7203,'TEST_USER3','ANALYST',7201,'2016/04/11',3400,'',60);
INSERT INTO CHAP10HW_EMP VALUES(7204,'TEST_USER4','MANAGER',7201,'2016/05/31',2700,300,60);
INSERT INTO CHAP10HW_EMP VALUES(7205,'TEST_USER5','CLERK',7201,'2016/07/20',2600,'',70);
INSERT INTO CHAP10HW_EMP VALUES(7206,'TEST_USER6','CLERK',7201,'2016/10/28',2300,'',80);
UPDATE CHAP10HW_EMP SET HIREDATE='2016/09/08',SAL=2600,DEPTNO=70 WHERE EMPNO=7206;
INSERT INTO CHAP10HW_EMP VALUES(7207,'TEST_USER7','LECTURER',7201,'2016/10/28',2300,'',80);
INSERT INTO CHAP10HW_EMP VALUES(7208,'TEST_USER8','STUDENT',7201,'2018/03/09',1200,'',80);


--3
UPDATE CHAP10HW_EMP SET DEPTNO=70 
WHERE SAL >(SELECT AVG(SAL)FROM CHAP10HW_EMP WHERE DEPTNO=50);

SELECT * FROM CHAP10HW_EMP WHERE DEPTNO=70;

--4
UPDATE CHAP10HW_EMP SET SAL=SAL*0.1,DEPTNO=80
WHERE HIREDATE > (SELECT MIN(HIREDATE) FROM CHAP10HW_EMP WHERE DEPTNO=60);

--5
DELETE FROM CHAP10HW_EMP
WHERE EMPNO IN(SELECT EMPNO FROM CHAP10HW_EMP E, CHAP10HW_SALGRADE S WHERE E.SAL BETWEEN S.LOSAL AND S.HISAL AND S.GRADE=5);
SELECT * FROM CHAP10HW_EMP;